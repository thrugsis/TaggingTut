//adds the new listing to the database and invisibly renders the listing with correct formatting, then adds it before all the other listings and fades it in slow. 
var new_listing = $("<%= escape_javascript(render(partial: @listing))%>").hide();
$('#listings').prepend(new_listing);
$('#listing_<%= @listing.id %>').fadeIn('slow');
//clears the input field
$('#new_listing')[0].reset();

  <% pane = panel.value %>
<% if !pane.value.to_s.gsub(/(\d{4})-(\d{2})-(\d{2})....(\d{4})-(\d{2})-(\d{2})/, '\6').to_i.nil?%>
  <% payment = 5*((pane.value.to_s.gsub(/(\d{4})-(\d{2})-(\d{2})....(\d{4})-(\d{2})-(\d{2})/, '\6').to_i) + 1 - (pane.value.to_s.gsub(/(\d{4})-(\d{2})-(\d{2})....(\d{4})-(\d{2})-(\d{2})/, '\3').to_i))%>
  <% if payment <= 0 %>
  // This had to do with the dates getting messed up when you had reservations that went through the monthly barrier. Not a working fix but puts it in the ballpark.
    <% payment += 29 %>
  <%end%>
<% else %>
<%end%>
